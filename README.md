# cian_parser
Собирает данные с ЦИАН по заданным ЖК и проводит аналитику

Программа собирает данные с ЦИАНа по новостройкам. На вход идет либо файл ID.xlsx, в котором в столбик перечислены id жилых комплексов, 
либо заранее заготовленный стандартный список, например, по Люберецкому и Ленинскому районам.
Также на вход идет proxy, который можно взять на сайте https://hidemyna.me/ru/proxy-list/. 
Ввод осуществляется в формате IP адрес:порт, например, 176.31.141.20:51327

Для контроля работы в консоли выводятся собираемые данные. Важно убедиться, что списки в консоли непустые. 
В противном случае необходима корректировка кода в связи с изменением верстки, рекомендуется обратиться к разработчику.

На выходе получается xlsx-файл, содержащий 2 листа: "Проекты" и "Аналитика". На первом листе выведен список всех объявлений,
на втором - аналитика по каждому типу квартир.

В файле otdelka.xlsx лежат цены за отдлеку за кв.м с указанием названия ЖК. Эти цены вычитаются из цены за метр в соответсвующих ЖК.

Парсер корректно работает пока только с объявлениями от застройщика, но при необходимости можно доработать по объявления от агентов и частных лиц.
В ходе работы парсера можно появится CAPTCHA, которую мы не сможем пройти, что приведет к остановке процесса парсинга, однако аналитика будет проведена по имеющимся данным. 
При необходимости процесс можно повторить исключая уже спарсенные жилые комплексы.

При повторном запуске рекомендуется удалять файл cookies.pkl

Для борьбы с CAPTCHA производим следующие действия:
1. Убираем из списка ЖК те, которые уже проанализированы.
2. Обновляем прокси
3. Запускаем снова

Если в результате повторного запуска сразу или почти сразу получаем CAPTCHA, то проводим корректировку cookies. 
Для этого необходимо через обычный бразуер зайти на сайт ЦИАН и подтвердить, что вы не робот. 
Далее раскомментировать код в строках 81-82 и закомментировать в строках 83-88. 
Переменной cookies на строке 81 присвоить актуальные значения для имеющихся там cookies.
Актуальные значения необходимо взять из браузера, в котором ранее проходилась CAPTCHА. 

При каждом новом запуске необходимо использовать новый прокси.

Если и это тоже не помогло, то стоит попробовать завтра, либо обратиться к разработчику.

Для работы требуется pandas, requests, BeautifulSoup, numpy, openpyxl, pickle
